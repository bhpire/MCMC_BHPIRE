\hypertarget{twister_8c}{}\section{twister.\+c File Reference}
\label{twister_8c}\index{twister.\+c@{twister.\+c}}


The Mersenne Twister random number generator.  


{\ttfamily \#include $<$stdio.\+h$>$}\\*
{\ttfamily \#include $<$stdlib.\+h$>$}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define {\bfseries N}~(624)\hypertarget{twister_8c_a0240ac851181b84ac374872dc5434ee4}{}\label{twister_8c_a0240ac851181b84ac374872dc5434ee4}

\item 
\#define {\bfseries M}~(397)\hypertarget{twister_8c_a52037c938e3c1b126c6277da5ca689d0}{}\label{twister_8c_a52037c938e3c1b126c6277da5ca689d0}

\item 
\#define {\bfseries K}~(0x9908\+B0\+D\+F\+U)\hypertarget{twister_8c_a97d832ae23af4f215e801e37e4f94254}{}\label{twister_8c_a97d832ae23af4f215e801e37e4f94254}

\item 
\#define {\bfseries hi\+Bit}(u)          ~((u) \& 0x80000000\+U)\hypertarget{twister_8c_a9fef977eac943a5f8b538ead34ceac7c}{}\label{twister_8c_a9fef977eac943a5f8b538ead34ceac7c}

\item 
\#define {\bfseries lo\+Bit}(u)          ~((u) \& 0x00000001\+U)\hypertarget{twister_8c_a68909716d0a95ca4551e9738ca82ddda}{}\label{twister_8c_a68909716d0a95ca4551e9738ca82ddda}

\item 
\#define {\bfseries lo\+Bits}(u)        ~((u) \& 0x7\+F\+F\+F\+F\+F\+F\+F\+U)\hypertarget{twister_8c_aae76bb72a8018058a8d070e83028e71d}{}\label{twister_8c_aae76bb72a8018058a8d070e83028e71d}

\item 
\#define {\bfseries mix\+Bits}(u,  v)~(hi\+Bit(u)$\vert$lo\+Bits(v))\hypertarget{twister_8c_a2ca02d83d9f95d1d37b56e20f9c30bd0}{}\label{twister_8c_a2ca02d83d9f95d1d37b56e20f9c30bd0}

\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef unsigned int {\bfseries uint32}\hypertarget{twister_8c_a1134b580f8da4de94ca6b1de4d37975e}{}\label{twister_8c_a1134b580f8da4de94ca6b1de4d37975e}

\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{twister_8c_ab5f4fe5f3a3acd5d6ff97ab53f3bf923}{seed\+MT} (uint32 seed)
\begin{DoxyCompactList}\small\item\em Seeding of the random generator. \end{DoxyCompactList}\item 
uint32 {\bfseries reload\+MT} (void)\hypertarget{twister_8c_ad05871d7fdd009889f599f7d41d5c02d}{}\label{twister_8c_ad05871d7fdd009889f599f7d41d5c02d}

\item 
uint32 \hyperlink{twister_8c_ab258ae2cb6be8b494bd2028e11fdf0b1}{random\+MT} (void)
\begin{DoxyCompactList}\small\item\em Random number generator. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
The Mersenne Twister random number generator. 

\href{http://www.math.keio.ac.jp/~matumoto/ver980409.html}{\tt http\+://www.\+math.\+keio.\+ac.\+jp/$\sim$matumoto/ver980409.\+html}

This is the ``\+Mersenne Twister\textquotesingle{}\textquotesingle{} random number generator M\+T19937, which generates pseudorandom integers uniformly distributed in 0..(2$^\wedge$32 -\/ 1) starting from any odd seed in 0..(2$^\wedge$32 -\/ 1). This version is a recode by Shawn Cokus (\href{mailto:Cokus@math.washington.edu}{\tt Cokus@math.\+washington.\+edu}) on March 8, 1998 of a version by Takuji Nishimura (who had suggestions from Topher Cooper and Marc Rieffel in July-\/\+August 1997).

Effectiveness of the recoding (on Goedel2.\+math.\+washington.\+edu, a D\+EC Alpha running O\+S\+F/1) using G\+CC -\/\+O3 as a compiler\+: before recoding\+: 51.\+6 sec. to generate 300 million random numbers; after recoding\+: 24.\+0 sec. for the same (i.\+e., 46.\+5\% of original time), so speed is now about 12.\+5 million random number generations per second on this machine.

According to the U\+RL \href{http:www.math.keio.ac.jp/~matumoto/emt.html}{\tt http\+:www.\+math.\+keio.\+ac.\+jp/$\sim$matumoto/emt.\+html} (and paraphrasing a bit in places), the Mersenne Twister is ``designed with consideration of the flaws of various existing generators,\textquotesingle{}\textquotesingle{} has a period of 2$^\wedge$19937 -\/ 1, gives a sequence that is 623-\/dimensionally equidistributed, and ``has passed many stringent tests, including the die-\/hard test of G. Marsaglia and the load test of P. Hellekalek and S. Wegenkittl.\textquotesingle{}\textquotesingle{} It is efficient in memory usage (typically using 2506 to 5012 bytes of static data, depending on data type sizes, and the code is quite short as well). It generates random numbers in batches of 624 at a time, so the caching and pipelining of modern systems is exploited. It is also divide-\/ and mod-\/free.

This library is free software; you can redistribute it and/or modify it under the terms of the G\+NU Library General Public License as published by the Free Software Foundation (either version 2 of the License or, at your option, any later version). This library is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY, without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU Library General Public License for more details. You should have received a copy of the G\+NU Library General Public License along with this library; if not, write to the Free Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-\/1307, U\+SA.

The code as Shawn received it included the following notice\+:

Copyright (C) 1997 Makoto Matsumoto and Takuji Nishimura. When you use this, send an e-\/mail to \href{mailto:matumoto@math.keio.ac.jp}{\tt matumoto@math.\+keio.\+ac.\+jp} with an appropriate reference to your work.

It would be nice to CC\+: \href{mailto:Cokus@math.washington.edu}{\tt Cokus@math.\+washington.\+edu} when you write.

\begin{DoxyAuthor}{Author}
Shawn Cokus (\href{mailto:Cokus@math.washington.edu}{\tt Cokus@math.\+washington.\+edu})
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
March 8, 1998
\end{DoxyDate}
No known bugs

\textbackslash{} warning No known warnings 

\subsection{Function Documentation}
\index{twister.\+c@{twister.\+c}!random\+MT@{random\+MT}}
\index{random\+MT@{random\+MT}!twister.\+c@{twister.\+c}}
\subsubsection[{\texorpdfstring{random\+M\+T(void)}{randomMT(void)}}]{\setlength{\rightskip}{0pt plus 5cm}uint32 random\+MT (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{twister_8c_ab258ae2cb6be8b494bd2028e11fdf0b1}{}\label{twister_8c_ab258ae2cb6be8b494bd2028e11fdf0b1}


Random number generator. 

Random number generator 

Definition at line 180 of file twister.\+c.

\index{twister.\+c@{twister.\+c}!seed\+MT@{seed\+MT}}
\index{seed\+MT@{seed\+MT}!twister.\+c@{twister.\+c}}
\subsubsection[{\texorpdfstring{seed\+M\+T(uint32 seed)}{seedMT(uint32 seed)}}]{\setlength{\rightskip}{0pt plus 5cm}void seed\+MT (
\begin{DoxyParamCaption}
\item[{uint32}]{seed}
\end{DoxyParamCaption}
)}\hypertarget{twister_8c_ab5f4fe5f3a3acd5d6ff97ab53f3bf923}{}\label{twister_8c_ab5f4fe5f3a3acd5d6ff97ab53f3bf923}


Seeding of the random generator. 

We initialize state\mbox{[}0..(N-\/1)\mbox{]} via the generator

x\+\_\+new = (69069 $\ast$ x\+\_\+old) mod 2$^\wedge$32

from Line 15 of Table 1, p. 106, Sec. 3.\+3.\+4 of Knuth\textquotesingle{}s {\itshape The Art of Computer Programming}, Volume 2, 3rd ed.

Notes (S\+JC)\+: I do not know what the initial state requirements of the Mersenne Twister are, but it seems this seeding generator could be better. It achieves the maximum period for its modulus (2$^\wedge$30) iff x\+\_\+initial is odd (p. 20-\/21, Sec. 3.\+2.\+1.\+2, Knuth); if x\+\_\+initial can be even, you have sequences like 0, 0, 0, ...; 2$^\wedge$31, 2$^\wedge$31, 2$^\wedge$31, ...; 2$^\wedge$30, 2$^\wedge$30, 2$^\wedge$30, ...; 2$^\wedge$29, 2$^\wedge$29 + 2$^\wedge$31, 2$^\wedge$29, 2$^\wedge$29 + 2$^\wedge$31, ..., etc. so I force seed to be odd below.

Even if x\+\_\+initial is odd, if x\+\_\+initial is 1 mod 4 then

the lowest bit of x is always 1, the next-\/to-\/lowest bit of x is always 0, the 2nd-\/from-\/lowest bit of x alternates ... 0 1 0 1 0 1 0 1 ... , the 3rd-\/from-\/lowest bit of x 4-\/cycles ... 0 1 1 0 0 1 1 0 ... , the 4th-\/from-\/lowest bit of x has the 8-\/cycle ... 0 0 0 1 1 1 1 0 ... , ...

and if x\+\_\+initial is 3 mod 4 then

the lowest bit of x is always 1, the next-\/to-\/lowest bit of x is always 1, the 2nd-\/from-\/lowest bit of x alternates ... 0 1 0 1 0 1 0 1 ... , the 3rd-\/from-\/lowest bit of x 4-\/cycles ... 0 0 1 1 0 0 1 1 ... , the 4th-\/from-\/lowest bit of x has the 8-\/cycle ... 0 0 1 1 1 1 0 0 ... , ...

The generator\textquotesingle{}s potency (min. s$>$=0 with (69069-\/1)$^\wedge$s = 0 mod 2$^\wedge$32) is 16, which seems to be alright by p. 25, Sec. 3.\+2.\+1.\+3 of Knuth. It also does well in the dimension 2..5 spectral tests, but it could be better in dimension 6 (Line 15, Table 1, p. 106, Sec. 3.\+3.\+4, Knuth).

Note that the random number user does not see the values generated here directly since reload\+M\+T() will always munge them first, so maybe none of all of this matters. In fact, the seed values made here could even be extra-\/special desirable if the Mersenne Twister theory says so-- that\textquotesingle{}s why the only change I made is to restrict to odd seeds. 

Definition at line 137 of file twister.\+c.

